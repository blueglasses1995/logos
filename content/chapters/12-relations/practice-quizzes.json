[
  {
    "id": "ch12-p1",
    "type": "multiple-choice",
    "question": "データベースの外部キー制約 (foreign key) は、数学的にはどのような関係に最も近いですか？",
    "options": [
      "関数的な関係（各行は参照先テーブルのちょうど1つの行を参照する）",
      "同値関係（参照するテーブルと参照されるテーブルは同値）",
      "全順序関係（テーブル間に順序がある）",
      "対称的関係（参照は双方向である）"
    ],
    "correctIndex": 0,
    "explanation": "外部キーは各行を参照先テーブルの1つの行に対応させます。これは関数（各入力に対して出力が一意に決まる特殊な関係）の性質と一致します。"
  },
  {
    "id": "ch12-p2",
    "type": "multiple-choice",
    "question": "Git のコミット履歴における「祖先関係」（コミット A がコミット B の祖先である）はどのような関係ですか？",
    "options": [
      "半順序（反射的、反対称的、推移的）",
      "同値関係（反射的、対称的、推移的）",
      "全順序（すべてのコミットが比較可能）",
      "対称的関係"
    ],
    "correctIndex": 0,
    "explanation": "自分自身は自分の祖先（反射的）、A が B の祖先で B が A の祖先なら A = B（反対称的）、A が B の祖先で B が C の祖先なら A は C の祖先（推移的）。ただしブランチがあると比較不能なコミットが存在するので全順序ではありません。"
  },
  {
    "id": "ch12-p3",
    "type": "multiple-choice",
    "question": "TypeScript の型システムにおける「extends」関係（A extends B）は、集合論的にどう解釈できますか？",
    "options": [
      "部分集合関係 A ⊆ B に類似する半順序関係",
      "同値関係（A extends B ならば B extends A）",
      "対称的関係（型の拡張は双方向）",
      "推移的でない関係"
    ],
    "correctIndex": 0,
    "explanation": "型 A が型 B を拡張するとは、A の値の集合が B の値の集合の部分集合であることを意味します。この関係は反射的（A extends A）、反対称的、推移的であり、半順序を構成します。"
  },
  {
    "id": "ch12-p4",
    "type": "counterexample",
    "argument": "関係 R が対称的かつ推移的であれば、R は反射的でもある。",
    "premises": ["R は対称的", "R は推移的"],
    "conclusion": "R は反射的",
    "vulnerablePremiseIndex": 0,
    "counterexamples": [
      { "id": "ce1", "text": "空関係 R = ∅ は（空虚に）対称的かつ推移的だが、A ≠ ∅ のとき反射的ではない", "isValid": true },
      { "id": "ce2", "text": "対称性と推移性から aRb → bRa → aRa と導ける", "isValid": false },
      { "id": "ce3", "text": "A = {1, 2}, R = {(1,1), (1,2), (2,1), (2,2)} は全て満たす", "isValid": false },
      { "id": "ce4", "text": "A = {1, 2, 3}, R = {(1,2), (2,1), (1,1), (2,2)} は対称的・推移的だが 3R3 が成り立たない", "isValid": true }
    ],
    "explanation": "対称性と推移性だけでは反射性は導けません。要素 a が関係 R に全く現れない場合、aRa を導く手段がありません。空関係は典型的な反例です。"
  },
  {
    "id": "ch12-p5",
    "type": "counterexample",
    "argument": "全順序関係では、すべての空でない部分集合に最小元が存在する。",
    "premises": ["(A, ≤) は全順序集合"],
    "conclusion": "A の任意の空でない部分集合には最小元が存在する",
    "vulnerablePremiseIndex": 0,
    "counterexamples": [
      { "id": "ce1", "text": "整数 ℤ 上の通常の ≤ は全順序だが、ℤ 自体に最小元はない", "isValid": true },
      { "id": "ce2", "text": "自然数 ℕ では最小元は常に存在する", "isValid": false },
      { "id": "ce3", "text": "開区間 (0, 1) 上の ≤ は全順序だが最小元が存在しない", "isValid": true },
      { "id": "ce4", "text": "有限集合の全順序では最小元が必ず存在する", "isValid": false }
    ],
    "explanation": "全順序でも無限集合の場合、最小元が存在しない部分集合がありえます。すべての空でない部分集合に最小元が存在する全順序を「整列順序（well-order）」と呼びます。自然数の ≤ は整列順序ですが、整数や実数の通常の ≤ はそうではありません。"
  }
]
